#!/bin/sh

username=${1}

echo "Setting up apt packages"
cat << EOF > /etc/apt/apt.conf.d/fucksuggested.conf
# generated by github.com/jaromil/dotfiles on 'sudo make install-apt'
APT::Get::Install-Recommends "false";
APT::Get::Install-Suggests "false";
APT::Install-Recommends "false";
APT::Install-Suggests "false";
EOF

apt-get install -y -q zsh fzf tmux htop iotop suckless-tools vim-nox git tig\
 software-properties-common apt-transport-https jq mosh direnv\
 mtr-tiny nnn apt-file mlocate pwgen silversearcher-ag liblnk-utils vbetool

# echo "Use doas instead of sudo, permit nopass"
# echo "permit nopass ${username}" > /etc/doas.conf

if [ -r /etc/sudoers.d/README ]; then
echo "Setting up sudoers for ${username}"
cat << EOF > /etc/sudoers.d/jrml_dotfiles
# generated by github.com/jaromil/dotfiles on 'sudo make install-apt'
Cmnd_Alias TOMB = /usr/local/bin/tomb
Defaults!TOMB !syslog
${username} ALL=NOPASSWD: TOMB, /usr/bin/apt, /usr/bin/apt-get
EOF
fi

echo "Starting mlocate and apt-file database updates in background"
(updatedb ; apt-file update) &


